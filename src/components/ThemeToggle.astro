---
// 主题切换按钮组件
---

<button
  id="theme-toggle"
  class="inline-flex items-center cursor-pointer border-none bg-transparent p-0 transition-transform duration-200 hover:scale-110 active:scale-95 not-underline-hover"
  aria-label="切换深色/浅色模式"
  title="切换主题"
>
  <span class="sun-icon i-mdi-weather-sunny w-6 h-6"></span>
  <span class="moon-icon i-mdi-weather-night w-6 h-6 hidden"></span>
</button>

<script>
  import { initWithSwup } from '~/scripts/dom/swup-lifecycle'
  import { initTheme, toggleTheme } from '~/scripts/ui/theme-toggle'

  function initThemeToggle() {
    const toggle = document.getElementById('theme-toggle')
    const sunIcon = toggle?.querySelector('.sun-icon')
    const moonIcon = toggle?.querySelector('.moon-icon')

    // Initialize theme on page load
    initTheme()

    // Update icon based on current theme
    function updateIcon() {
      const isDark = document.documentElement.classList.contains('dark')
      if (sunIcon && moonIcon) {
        if (isDark) {
          sunIcon.classList.add('hidden')
          moonIcon.classList.remove('hidden')
        } else {
          sunIcon.classList.remove('hidden')
          moonIcon.classList.add('hidden')
        }
      }
    }

    updateIcon()

    // Toggle theme on click
    toggle?.addEventListener('click', () => {
      toggleTheme()
      updateIcon()
    })
  }

  initWithSwup(initThemeToggle)
</script>
